variable "countries" {
  description = "List of allowed countries"
  type = list(list(string))
  default = [
    ["AD", "AT", "BE", "DK", "FR", "DE", "GR", "FI", "IS", "IE" ],
    ["IL", "IT", "LI", "LU", "MT", "MC", "NL", "NO", "PT", "SM" ],
    [ "ES", "SE", "CH", "US", "GB", "JP", "PL" ]
  ]
}

variable "ips" {
  description = "Blocked IPs list"
  type = list(list(string))
  default = [
    [
      "1.15.51.173",
      "1.202.114.244",
      "101.68.211.3",
      "103.101.225.209",
      "103.123.86.190",
      "103.133.107.210",
      "103.153.77.170",
      "103.156.91.51",
      "103.167.175.11",
      "103.184.112.184",
      "103.203.56.1",
      "103.203.57.10",
      "103.203.57.25",
      "103.203.59.1",
      "103.207.42.178",
      "103.216.59.182",
      "104.140.188.26",
      "104.140.188.30",
      "104.140.188.38",
      "104.140.188.54",
      "104.206.128.22",
      "104.207.139.84",
      "104.248.40.209",
      "104.248.5.240",
      "104.248.51.8",
      "104.47.73.126",
      "104.47.73.254",
      "106.75.103.149",
      "106.75.134.236",
      "106.75.148.201",
      "106.75.173.75",
      "107.152.217.4",
      "107.178.231.243",
      "107.178.232.190",
      "107.189.28.71",
      "107.21.143.17",
      "108.26.201.185",
      "109.205.181.208",
      "109.205.182.80",
      "109.234.29.126",
      "109.237.103.118",
      "109.237.103.123",
      "109.237.103.9",
      "109.86.239.53",
      "110.164.180.66",
      "111.7.96.169",
      "114.119.128.35",
      "114.119.131.33",
      "114.119.132.248",
      "114.119.136.69",
      "114.119.137.43",
      "114.119.140.21",
      "114.119.143.145",
      "114.119.144.116",
      "114.119.146.197",
      "115.42.45.204",
      "115.50.60.60",
      "120.52.152.20",
      "120.52.152.5",
      "120.86.255.240",
      "122.116.44.189",
      "122.175.208.217",
      "125.135.94.67",
      "125.212.226.31",
      "128.1.185.104",
      "128.1.248.26",
      "128.1.248.42",
      "128.14.133.58",
      "128.14.134.134",
      "128.14.134.170",
      "128.14.141.34",
      "128.14.209.162",
      "128.14.209.170",
      "128.14.209.226",
      "128.14.209.234",
      "128.199.160.152",
      "128.76.137.166",
      "13.66.132.53",
      "13.86.227.142",
      "130.211.54.158",
      "134.209.150.178",
      "134.249.150.143",
      "137.184.37.76",
      "138.197.194.139",
      "138.197.217.233",
      "138.197.72.76",
      "138.68.13.82",
      "138.68.14.236",
      "138.68.144.74",
      "138.68.249.116",
      "138.68.4.4",
      "138.99.216.122",
      "139.162.145.250",
      "139.162.200.114",
      "139.162.215.70",
      "139.162.236.205",
      "14.204.44.3",
      "141.98.10.171",
      "141.98.83.121",
      "141.98.83.125",
      "141.98.83.126",
      "141.98.83.131",
      "141.98.83.132",
      "141.98.83.133",
      "141.98.83.84",
      "141.98.83.85",
      "141.98.83.86",
      "142.93.146.198",
      "142.93.170.3",
      "143.198.136.88",
      "143.198.25.13",
      "143.198.71.212",
      "143.198.8.32",
      "144.22.198.141",
      "144.91.69.249",
      "144.91.90.75",
      "147.78.47.154",
      "147.78.47.29",
      "147.78.47.40",
      "147.78.47.42",
      "148.63.241.17",
      "149.129.50.37",
      "149.56.141.187",
      "149.57.161.118",
      "152.32.143.122",
      "154.209.125.47",
      "154.209.125.48",
      "156.146.50.169",
      "156.204.21.163",
      "157.230.216.203",
      "157.245.176.143",
      "157.245.70.127",
      "157.245.96.143",
      "157.55.39.33",
      "157.55.39.34",
      "157.55.39.35",
      "157.55.39.87",
      "159.203.74.199",
      "159.223.180.164",
      "159.223.180.198",
      "159.223.22.5",
      "159.223.25.249",
      "159.65.17.102",
      "159.65.52.197",
      "159.89.36.48",
      "160.116.22.20",
      "160.116.22.21",
      "161.35.181.161",
      "161.35.188.242",
      "161.35.230.183",
      "161.35.238.241",
      "161.35.86.181",
      "162.142.125.10",
      "162.142.125.121",
      "162.142.125.210",
      "162.142.125.212",
      "162.142.125.219",
      "162.142.125.220",
      "162.142.125.222",
      "162.142.125.58",
      "162.142.125.7",
      "162.142.125.8",
      "162.142.125.9",
      "162.221.192.26",
      "162.62.191.231",
      "164.52.24.166",
      "164.52.24.190",
      "164.90.197.24",
      "164.92.160.98",
      "164.92.191.197",
      "164.92.252.4",
      "165.22.120.43",
      "165.227.41.60",
      "167.248.133.120",
      "167.248.133.44",
      "167.248.133.45",
      "167.248.133.46",
      "167.248.133.60",
      "167.248.133.61",
      "167.248.133.62",
      "167.248.133.63",
      "167.71.165.231",
      "167.71.180.188",
      "167.71.98.164",
      "167.94.138.117",
      "167.94.138.118",
      "167.94.138.119",
      "167.94.138.120",
      "167.94.138.44",
      "167.94.138.45",
      "167.94.138.46",
      "167.94.138.47",
      "167.94.138.57",
      "167.94.138.61",
      "167.94.138.62",
      "167.94.138.63",
      "167.94.145.57",
      "167.94.145.58",
      "167.94.145.59",
      "167.94.145.60",
      "167.94.146.57",
      "167.94.146.58",
      "167.94.146.59",
      "167.94.146.60",
      "167.99.60.254",
      "168.232.15.138",
      "168.235.86.13",
      "170.106.115.151",
      "170.130.187.10",
      "170.210.45.163",
      "171.25.193.20",
      "171.25.193.25",
      "171.25.193.77",
      "172.105.161.142",
      "172.105.189.111",
      "172.105.85.90",
      "172.105.89.161",
      "173.225.110.122",
      "173.249.53.50",
      "175.100.20.245",
      "176.111.174.116",
      "176.111.174.131",
      "176.111.174.144",
      "176.111.174.72",
      "176.58.107.153",
      "177.229.201.202",
      "178.17.174.14",
      "178.73.215.171",
      "179.43.170.170",
      "179.60.147.204",
      "179.60.150.89",
      "18.118.35.125",
      "18.144.66.115",
      "18.232.134.119",
      "183.136.225.9",
      "183.136.226.3",
      "184.105.139.108",
      "184.105.139.114",
      "184.105.139.67",
      "184.105.139.68",
      "184.105.139.70",
      "184.105.139.71",
      "184.105.139.86",
      "184.105.139.87",
      "184.105.139.90",
      "184.105.247.194",
      "184.105.247.252",
      "185.100.84.240",
      "185.100.87.202",
      "185.142.236.35",
      "185.142.236.41",
      "185.142.236.43",
      "185.162.235.219",
      "185.165.190.34",
      "185.173.35.25",
      "185.173.35.5",
      "185.173.35.57",
      "185.180.143.137",
      "185.180.143.138",
      "185.180.143.140",
      "185.180.143.143",
      "185.180.143.7",
      "185.180.143.72",
      "185.180.143.79",
      "185.180.143.8",
      "185.190.24.35",
      "185.196.220.70",
      "185.220.100.0/24",
      "185.220.100.253",
      "185.220.101.0/24",
      "185.220.101.161",
      "185.220.101.187",
      "185.220.101.77",
      "185.222.57.252",
      "185.3.94.140",
      "185.38.175.132",
      "185.83.214.69",
      "186.233.180.156",
      "192.227.137.46",
      "192.241.205.55",
      "192.241.206.122",
      "192.241.207.202",
      "192.241.208.75",
      "192.241.209.152",
      "192.241.209.99",
      "192.241.210.66",
      "192.241.211.176",
      "192.241.212.195",
      "192.241.212.81",
      "192.241.213.152",
      "192.241.213.20",
      "192.241.213.57",
      "192.241.214.19",
      "192.241.219.87",
      "192.241.223.66",
      "192.3.164.187",
      "193.118.53.194",
      "193.118.53.202",
      "193.118.53.210",
      "193.37.255.114",
      "193.46.254.155",
      "193.56.29.173",
      "194.165.16.10",
      "194.165.16.29",
      "194.165.16.72",
      "194.165.16.73",
      "194.165.16.78",
      "194.165.16.8",
      "194.26.29.25",
      "194.31.98.205",
      "194.48.199.78",
      "195.133.40.42",
      "195.144.21.56",
      "195.254.135.76",
      "195.54.161.250",
      "198.12.99.108",
      "198.20.69.98",
      "198.20.87.98",
      "198.235.24.132",
      "198.235.24.137",
      "198.235.24.139",
      "198.235.24.141",
      "198.235.24.142",
      "198.235.24.144",
      "198.235.24.147",
      "198.235.24.15",
      "198.235.24.152",
      "198.235.24.158",
      "198.235.24.2",
      "198.235.24.21",
      "198.235.24.22",
      "198.235.24.25",
      "198.235.24.29",
      "198.46.156.186",
      "198.96.155.3",
      "198.98.54.150",
      "199.195.250.77",
      "2.56.57.72",
      "2.56.59.20",
      "2.57.121.10",
      "2.58.149.136",
      "2.58.149.222",
      "20.210.88.162",
      "20.213.51.37",
      "20.38.171.33",
      "20.41.96.162",
      "20.51.243.108",
      "20.51.244.186",
      "20.51.244.99",
      "20.53.253.54",
      "20.55.112.150",
      "20.55.112.39",
      "20.55.53.144",
      "20.55.64.250",
      "20.74.249.113",
      "20.96.13.51",
      "202.53.136.38",
      "205.185.117.203",
      "205.185.122.184",
      "205.185.125.167",
      "205.185.127.43",
      "205.210.31.12",
      "205.210.31.13",
      "205.210.31.134",
      "205.210.31.136",
      "205.210.31.137",
      "205.210.31.139",
      "205.210.31.146",
      "205.210.31.15",
      "205.210.31.150",
      "205.210.31.156",
      "205.210.31.17",
      "205.210.31.20",
      "205.210.31.23",
      "205.210.31.35",
      "205.210.31.6",
      "205.210.31.8",
      "205.210.31.9",
      "206.166.251.210",
      "207.223.191.142",
      "207.244.97.185",
      "207.46.13.171",
      "208.100.26.233",
      "208.100.26.236",
      "208.100.26.237",
      "208.100.26.246",
      "208.100.26.247",
      "208.115.225.119",
      "208.115.245.107",
      "209.126.136.3",
      "209.141.35.105",
      "209.141.35.128",
      "209.141.36.112",
      "209.141.36.231",
      "209.141.41.193",
      "209.141.51.49",
      "209.141.55.26",
      "209.141.57.178",
      "209.141.58.146",
      "209.17.96.10",
      "209.17.96.114",
      "209.17.96.130",
      "209.17.96.138",
      "209.17.96.154",
      "209.17.96.170",
      "209.17.96.18",
      "209.17.96.186",
      "209.17.96.194",
      "209.17.96.2",
      "209.17.96.210",
      "209.17.96.242",
      "209.17.96.26",
      "209.17.96.34",
      "209.17.96.42",
      "209.17.96.50",
      "209.17.96.66",
      "209.17.96.90",
      "209.17.96.98",
      "209.17.97.10",
      "209.17.97.114",
      "209.17.97.26",
      "209.17.97.34",
      "209.17.97.42",
      "209.17.97.90",
      "209.17.97.98",
      "210.1.8.62",
      "212.103.60.106",
      "212.76.102.187",
      "213.226.123.30",
      "213.32.122.82",
      "216.218.206.66",
      "216.218.206.68",
      "216.218.206.82",
      "217.146.82.22",
      "219.154.102.255",
      "221.120.160.130",
      "23.129.64.0/24",
      "23.129.64.132",
      "23.129.64.134",
      "23.129.64.136",
      "23.129.64.139",
      "23.129.64.211",
      "23.225.180.3",
      "23.236.147.154",
      "23.250.19.242",
      "23.251.102.74",
      "23.251.102.82",
      "3.101.153.4",
      "3.112.245.164",
      "3.230.171.174",
      "3.251.74.46",
      "3.85.171.70",
      "31.220.3.140",
      "31.43.185.65",
      "31.7.65.77",
      "34.140.248.32",
      "34.222.174.222",
      "34.222.201.65",
      "34.222.203.77",
      "34.223.60.71",
      "34.78.76.227",
      "34.79.45.96",
      "34.96.130.31",
      "34.96.130.5",
      "35.171.162.28",
      "35.185.241.102",
      "35.195.93.98",
      "35.225.82.182",
      "35.233.62.116",
      "35.245.188.175",
      "35.247.116.70",
      "35.80.31.129",
      "35.83.249.63",
      "35.85.254.60",
      "35.86.186.108",
      "35.86.205.48",
      "35.86.228.85",
      "35.88.48.240",
      "36.37.140.107",
      "36.68.8.170",
      "37.57.137.208",
      "37.76.197.225",
      "38.106.120.134",
      "38.242.226.253",
      "39.104.22.126",
      "4.17.224.131",
      "4.28.87.68",
      "40.69.195.15",
      "40.77.167.104",
      "40.94.26.133",
      "40.94.26.138",
      "40.94.26.155",
      "40.94.26.157",
      "40.94.26.163",
      "40.94.26.165",
      "40.94.26.175",
      "40.94.26.203",
      "40.94.26.215",
      "40.94.28.20",
      "40.94.28.22",
      "40.94.28.31",
      "40.94.28.43",
      "40.94.28.50",
      "40.94.28.7",
      "40.94.28.86",
      "41.60.216.154",
      "41.92.186.205",
      "42.239.230.178",
      "43.129.33.99",
      "43.129.39.176",
      "43.130.11.228",
      "43.131.66.209",
      "43.139.1.219",
      "43.153.10.221",
      "44.226.206.233",
      "44.234.50.104",
      "45.129.56.200",
      "45.13.170.133",
      "45.134.144.129",
      "45.134.144.134",
      "45.134.144.140",
      "45.135.232.172",
      "45.137.21.208",
      "45.137.23.135",
      "45.146.165.168",
      "45.146.165.37",
      "45.153.160.0/24",
      "45.154.255.147",
      "45.155.204.146",
      "45.182.156.15",
      "45.227.254.10",
      "45.227.254.26",
      "45.227.254.48",
      "45.227.254.51",
      "45.227.254.52",
      "45.227.254.53",
      "45.227.254.55",
      "45.227.254.56",
      "45.227.254.8",
      "45.33.65.249",
      "45.33.96.205",
      "45.33.99.138",
      "45.79.204.46",
      "45.83.64.191",
      "45.83.66.213",
      "45.83.66.217",
      "45.83.67.8",
      "45.87.61.162",
      "45.95.169.50",
      "46.101.176.113",
      "46.101.54.110",
      "46.225.248.12",
      "46.243.179.101",
      "46.43.99.118",
      "46.60.48.183",
      "47.253.47.24",
      "47.253.61.221",
      "47.253.97.203",
      "47.90.212.247",
      "49.143.32.6",
      "49.233.47.13",
      "49.89.13.240",
      "5.183.209.237",
      "5.188.210.227",
      "5.255.253.140",
      "5.62.20.26",
      "51.12.85.121",
      "51.15.43.20",
      "51.15.43.205",
      "51.15.76.60",
      "51.158.108.77",
      "51.158.118.231",
      "51.159.102.248",
      "51.159.164.227",
      "51.159.4.144",
      "51.195.45.190",
      "51.254.59.113",
      "51.79.29.48",
      "51.79.85.144",
      "51.83.87.169",
      "52.114.75.216",
      "52.114.77.236",
      "52.12.35.179",
      "52.151.4.214",
      "52.151.48.191",
      "52.151.48.199",
      "52.171.199.157",
      "52.187.70.179",
      "52.191.188.95",
      "52.229.98.178",
      "52.53.158.217",
      "52.53.178.29",
      "54.153.39.116",
      "54.158.254.192",
      "54.177.36.10",
      "54.183.213.223",
      "54.183.222.215",
      "54.183.99.47",
      "54.193.55.177",
      "54.204.135.39"
  ], [
      "54.215.187.117",
      "54.215.27.245",
      "54.227.204.163",
      "54.36.108.162",
      "54.37.159.20",
      "54.91.128.206",
      "61.219.11.152",
      "62.102.148.68",
      "62.102.148.69",
      "62.148.70.94",
      "62.171.149.200",
      "62.171.150.168",
      "62.233.50.179",
      "62.233.51.213",
      "64.225.1.215",
      "64.225.14.92",
      "64.227.97.195",
      "64.227.99.233",
      "64.31.7.230",
      "64.62.197.142",
      "64.62.197.212",
      "64.62.197.219",
      "64.62.197.231",
      "64.62.197.32",
      "64.62.197.37",
      "64.62.197.43",
      "64.62.197.62",
      "64.62.197.64",
      "64.62.197.66",
      "64.62.197.76",
      "64.62.197.77",
      "64.62.197.78",
      "64.62.197.84",
      "64.62.197.91",
      "65.49.20.101",
      "65.49.20.103",
      "65.49.20.105",
      "65.49.20.107",
      "65.49.20.115",
      "65.49.20.122",
      "65.49.20.66",
      "65.49.20.67",
      "65.49.20.68",
      "65.49.20.69",
      "65.49.20.71",
      "65.49.20.73",
      "65.49.20.75",
      "65.49.20.77",
      "65.49.20.89",
      "66.240.192.138",
      "66.240.192.82",
      "66.240.205.34",
      "66.240.236.119",
      "67.209.206.254",
      "67.69.76.108",
      "68.183.148.238",
      "71.6.165.200",
      "71.6.167.142",
      "71.6.199.23",
      "71.6.232.2",
      "71.6.232.4",
      "71.6.232.6",
      "71.6.232.7",
      "71.6.232.8",
      "74.82.47.15",
      "74.82.47.3",
      "74.82.47.4",
      "74.82.47.51",
      "74.82.47.7",
      "78.110.72.50",
      "78.128.113.170",
      "78.188.236.45",
      "78.188.87.201",
      "78.38.55.8",
      "79.143.179.238",
      "79.53.107.178",
      "8.31.2.43",
      "8.31.2.45",
      "8.31.2.94",
      "80.151.168.2",
      "80.241.222.193",
      "80.30.138.181",
      "80.66.88.206",
      "80.66.88.208",
      "80.66.88.209",
      "80.66.88.210",
      "80.66.88.211",
      "80.66.88.212",
      "80.66.88.213",
      "80.82.77.192",
      "80.85.85.235",
      "80.94.93.250",
      "80.94.93.3",
      "80.99.170.91",
      "81.12.93.56",
      "81.17.18.58",
      "81.17.18.59",
      "81.17.24.154",
      "81.39.111.122",
      "82.207.44.156",
      "85.115.53.140",
      "86.254.58.83",
      "87.236.176.178",
      "87.236.176.234",
      "87.251.64.140",
      "87.251.64.160",
      "87.251.64.175",
      "87.251.67.65",
      "88.247.159.107",
      "88.249.57.224",
      "88.249.64.196",
      "88.80.187.183",
      "88.80.187.252",
      "88.80.189.57",
      "89.163.231.26",
      "89.248.172.16",
      "91.106.199.75",
      "91.191.209.46",
      "91.211.89.107",
      "91.211.89.43",
      "91.240.118.184",
      "91.240.242.202",
      "91.245.254.44",
      "92.118.160.37",
      "92.118.160.41",
      "92.118.161.9",
      "92.255.85.152",
      "92.255.85.166",
      "92.255.85.195",
      "92.28.2.68",
      "93.48.159.60",
      "94.102.49.193",
      "94.102.56.11",
      "94.102.61.10",
      "94.102.61.8",
      "94.140.114.213",
      "94.182.212.48",
      "94.183.194.210",
      "94.232.42.104",
      "94.232.42.23",
      "94.232.43.10",
      "94.232.43.14",
      "94.232.43.62",
      "94.232.45.251",
      "94.232.47.180",
      "94.65.173.112",
      "95.111.240.130",
      "95.217.111.153",
      "95.233.243.138",
      "95.82.146.95",
      "95.9.202.205"
    ]
  ]
}